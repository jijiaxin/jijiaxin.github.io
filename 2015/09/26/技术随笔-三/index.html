	<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>技术随笔(三) | 微凉一季</title>
  <meta name="author" content="季訫">
  
  <meta name="description" content="往事如烟，随风而逝">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="技术随笔(三)"/>
  <meta property="og:site_name" content="微凉一季"/>

  
  
		<!-- favicon -->
		<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.png">
		<meta name="theme-color" content="#009688">
		<!-- favicon end -->
    <!-- <link href="/favicon.ico" rel="icon"> -->
  

  <!-- toc -->
  <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css">

  <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">

  <!-- material design -->
	<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css">
  <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
	<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  
  <!-- 百度统计 -->
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?965a6e7fe7dbf925b4191360c79b5e64";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  

  

  <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/libs/jquery-2.0.3.min.js" type="text/javascript"><\/script>')</script>

</head>

 	<body>
	  <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">菜单</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">微凉一季</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/" title="">
                    <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                <li>
                    <a href="/archives" title="">
                    <i class="fa fa-list"></i>存档
                    </a>
                </li>
                
                <li>
                    <a href="/about" title="">
                    <i class="fa fa-info-circle"></i>关于
                    </a>
                </li>
                
                <li>
                    <a href="/atom.xml" title="这是一个订阅源">
                    <i class="fa fa-rss"></i>RSS
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

	  <div class="container" >
	    <div class="row">
	
	<div class="col-md-9 center-content">
	

		<div class="content">
			<!-- index -->
		   

			  		<h2>技术随笔(三)</h2>
					
					<div>
						<span class="post-time">2015-09-26 10:38:29</span>
					</div>	
					

					<div class="article-content">
						<h4 id="2015-09-29-周三-10-38-29"><a href="#2015-09-29-周三-10-38-29" class="headerlink" title="2015-09-29  周三  10:38:29"></a>2015-09-29  周三  10:38:29</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//正则表达式匹配</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">regexFileChecker</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">    String regex = <span class="string">"^[0-9]+\\.(m|M)(p|P)4$"</span>;</div><div class="line">    Pattern pattern = Pattern.compile(regex);</div><div class="line">    Matcher matcher = pattern.matcher(str);</div><div class="line">    <span class="keyword">return</span> matcher.matches();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//getImageResourceId()方法的作用就是根据图片命找到系统资源</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getImageResourceId</span><span class="params">( Context context )</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">try</span>  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">return</span> context.getResources().getIdentifier(<span class="keyword">this</span>.picName, <span class="string">"drawable"</span>, context.getPackageName());  </div><div class="line"></div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">catch</span> (Exception e)  </div><div class="line">    &#123;  </div><div class="line">        e.printStackTrace();  </div><div class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line">&#125;  </div><div class="line"></div><div class="line">注释模板</div><div class="line"><span class="comment">/**</span></div><div class="line"> * $&#123;see_to_overridden&#125;</div><div class="line"> */</div></pre></td></tr></table></figure>
<p>9/30 周三 23:03<br>　　王慧文却毫不讳言，美团真正深感骄傲的是，其拥有一支执行力超强、让对手生畏的地推“铁军”。据悉，地推人员在进入商户贴上美团海报前，不是覆盖住对手海报就可以，会将后者先撕个粉碎。﻿</p>
<p>　　“不要总想着靠巨头，这个世界生存的关键是自立自强。老大看中你，首先是因为你能够自立自强。”他说。﻿</p>
<a id="more"></a>
<h4 id="10-12-周一-13-56"><a href="#10-12-周一-13-56" class="headerlink" title="10/12 周一 13:56"></a>10/12 周一 13:56</h4><p>专用的观察者模式<br><code>Button</code> ——-<code>onClick(View)</code>———&gt; <code>OnClickListener</code><br>通用的观察者模式<br>（被观察者）<code>Observable</code> ——– <code>onEvent(Params)</code>——–&gt; <code>Observer</code>(观察者)</p>
<p>（<code>Button</code> -&gt; 被观察者、<code>OnClickListener</code> -&gt; 观察者、<code>setOnClickListener()</code> -&gt; 订阅，<code>onClick()</code> -&gt; 事件）</p>
<p>RxJava 有四个基本概念：<code>Observable</code> (可观察者，即被观察者)、 <code>Observer</code> (观察者)、 <code>subscribe</code> (订阅)、事件。<code>Observable</code> 和 <code>Observer</code> 通过 <code>subscribe()</code> 方法实现订阅关系，从而 <code>Observable</code> 可以在需要的时候发出事件来通知 <code>Observer</code>。</p>
<p>与传统观察者模式不同， RxJava 的事件回调方法除了普通事件 <code>onNext()</code> （相当于 <code>onClick()</code> / <code>onEvent()</code>）之外，还定义了两个特殊的事件：<code>onCompleted()</code>事件队列完结 和 <code>onError()</code>事件队列异常。在一个正确运行的事件序列中, <code>onCompleted()</code> 和 <code>onError()</code> 有且只有一个，并且是事件序列中的最后一个。</p>
<p>详细来自<a href="http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="external">gankio</a></p>
<h4 id="10-13-周二-15-41"><a href="#10-13-周二-15-41" class="headerlink" title="10/13 周二 15:41"></a>10/13 周二 15:41</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[2015-10-13 15:08:40 - Framework Resource Parser] Collect preferences failed, class com/android/org/conscrypt/PSKKeyManager not found in D:\worktools\android-sdk-windows\platforms\android-22\android.jar</div></pre></td></tr></table></figure>
<p>这个问题，考虑到之前曾扩充这个22版的jar，加入了ActivityThread等类，可能与之相关。。<br>换回原先的原生的包，就没问题了，与以下报错的bug无关，只是顺道发现的一个报警，不太需要管。</p>
<p>然后项目所有涉及到的资源文件都报错。考虑到之前由于base包不能修改，改了下base包的靠上了，结果出现此奇葩问题。还好想起了base包的事儿，否则要蛋疼很久了。。。</p>
<p>思路：其他项目没有报错，只有这个工程报错，所以应该是项目自身的问题，而不是ADT版本之类的原因，而项目的问题，自然就是项目配置的问题了，因而很自然想到了刚才弄过的base包了。这种网上搜不到的奇葩问题，首先不要惊慌，要推理，像侦探一样，哈哈。eclipse真的很烂。</p>
<h4 id="10-16-周五-16-40"><a href="#10-16-周五-16-40" class="headerlink" title="10/16 周五 16:40"></a>10/16 周五 16:40</h4><p>今天同事告诉我一个小tips，别看一个简单的textview，里面不知道的学问还真不少呢。<br>设置textview上下滚动<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">注意后两句</div><div class="line">&lt;TextView</div><div class="line">    android:id=<span class="string">"@+id/content"</span></div><div class="line">    android:layout_width=<span class="string">"fill_parent"</span></div><div class="line">    android:layout_height=<span class="string">"wrap_content"</span></div><div class="line">    android:text=<span class="string">"file content is empty!"</span></div><div class="line">    android:scrollbars=<span class="string">"vertical"</span></div><div class="line">    android:fadeScrollbars=<span class="string">"false"</span>/&gt;</div><div class="line">然后：</div><div class="line">mTextView.setMovementMethod(ScrollingMovementMethod.getInstance());</div></pre></td></tr></table></figure></p>
<h4 id="10-17-周六-10-32"><a href="#10-17-周六-10-32" class="headerlink" title="10/17 周六 10:32"></a>10/17 周六 10:32</h4><p>用户态（user mode）在计算机结构指两项类似的概念。在CPU的设计中，用户态指非特权状态。在此状态下，执行的代码被硬件限定，不能进行某些操作，比如写入其他进程的存储空间，以防止给操作系统带来安全隐患。在操作系统的设计中，用户态也类似，指非特权的执行状态。内核禁止此状态下的代码进行潜在危险的操作，比如写入系统配置文件、杀掉其他用户的进程、重启系统等。<br>当一个任务（进程）执行系统调用而陷入内核代码中执行时，我们就称进程处于内核运行态（或简称为内核态）。此时处理器处于特权级最高的（0 级）内核代码中执行。当进程处于内核态时，执行的内核代码会使用当前进程的内核栈。每个进程都有自己的内核栈。<br>用系统调用时进入核心态。Linux 对硬件的操作只能在核心态，这可以通过写驱动程序来控制。在用户态操作硬件会造成core dump。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> jjx;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestTips</span></span>&#123;</div><div class="line">    </div><div class="line">    HashMap&lt;Long, String&gt; map = <span class="keyword">new</span> HashMap&lt;Long,String&gt;();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</div><div class="line">        TestTips mTestTips = <span class="keyword">new</span> TestTips();</div><div class="line">        mTestTips.map.put((<span class="keyword">long</span>)<span class="number">0</span>, <span class="string">"Cheetah"</span>);</div><div class="line">        System.out.println(<span class="string">"(long)0 "</span>+ (<span class="keyword">long</span>)<span class="number">0</span>);</div><div class="line">        mTestTips.map.put(Long.valueOf(<span class="number">1</span>), <span class="string">"Mobile"</span>);</div><div class="line">        System.out.println(<span class="string">"Long.valueOf(1) "</span>+ Long.valueOf(<span class="number">1</span>));</div><div class="line">        <span class="comment">// String value1 = mTestTips.map.get(0); 输出为null</span></div><div class="line">        String value1 = mTestTips.map.get(<span class="number">0L</span>);</div><div class="line">        System.out.println(<span class="string">"1 "</span>+ value1);</div><div class="line">        <span class="comment">// String value2 = mTestTips.map.get(1); 输出为null</span></div><div class="line">        String value2 = mTestTips.map.get(<span class="number">1L</span>);</div><div class="line">        System.out.println(<span class="string">"2 "</span>+ value2);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">输出：</div><div class="line">(<span class="keyword">long</span>)<span class="number">0</span> <span class="number">0</span></div><div class="line">Long.valueOf(<span class="number">1</span>) <span class="number">1</span></div><div class="line"><span class="number">1</span> Cheetah</div><div class="line"><span class="number">2</span> Mobile</div></pre></td></tr></table></figure>
<p>邂逅bug：<br>安装app提示：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Installation failed due to invalid URI!</div><div class="line">Please check logcat output <span class="keyword">for</span> more details.</div><div class="line">Launch canceled!</div></pre></td></tr></table></figure></p>
<p>解决：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">adb shell</div><div class="line">cd /data</div><div class="line">chmod <span class="number">777</span> local</div></pre></td></tr></table></figure></p>
<p>分析：<br>手机local目录下有个logs目录，里面是都log记录文件，而查看local目录的权限发现：<br>写log权限不足，安装的时候必定产生log信息以及需要对/data/local/tmp目录的写权限，这就导致问题的产生。<br>应该是安全软件修改了。昨天刚装了个绿色守护软件。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//系统自带的颜色类</div><div class="line">textView.setTextColor(android.graphics.Color.RED);</div><div class="line">//0xffff00ff是int类型的数据，分组一下0x|ff|ff00ff，0x是代表颜色整数的标记，ff是表示透明度，ff00ff表示颜色，</div><div class="line">//注意：这里ffff00ff必须是8个的颜色表示，不接受ff00ff这种6个的颜色表示。</div><div class="line">textView.setTextColor(0xffff00ff);</div><div class="line">//还是利用Color类；</div><div class="line">textView.setTextColor(android.graphics.Color.parseColor(“#87CEFA”)) ;</div><div class="line">//从资源获取 </div><div class="line">textView.setTextColor(this.getResources().getColor(R.color.red));</div></pre></td></tr></table></figure>
<p>lenovo solusion center是一个服务。</p>
<h4 id="10-24-周六-20-43"><a href="#10-24-周六-20-43" class="headerlink" title="10/24 周六 20:43"></a>10/24 周六 20:43</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomTextView</span> <span class="keyword">extends</span> <span class="title">TextView</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = CustomTextView.class.getSimpleName();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomTextView</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomTextView</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>(context, attrs, R.attr.CustomizeStyle);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomTextView</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.Customize, defStyle, R.style.DefaultCustomizeStyle);</div><div class="line">        String one = a.getString(R.styleable.Customize_attr_one);</div><div class="line">        String two = a.getString(R.styleable.Customize_attr_two);</div><div class="line">        String three = a.getString(R.styleable.Customize_attr_three);</div><div class="line">        String four = a.getString(R.styleable.Customize_attr_four);</div><div class="line">        Log.i(TAG, <span class="string">"one:"</span> + one);</div><div class="line">        Log.i(TAG, <span class="string">"two:"</span> + two);</div><div class="line">        Log.i(TAG, <span class="string">"three:"</span> + three);</div><div class="line">        Log.i(TAG, <span class="string">"four:"</span> + four);</div><div class="line">        a.recycle();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>自定义view：如果在Code中实例化一个View会调用第一个构造函数，如果在xml中定义会调用第二个构造函数，而第三个函数系统是不调用的，要由View（我们自定义的或系统预定义的View，如此处的CustomTextView和Button）显式调用，比如在这里我们在第二个构造函数中调用了第三个构造函数，并将R.attr.CustomizeStyle传给了第三个参数。<br>第三个参数的意义就如同它的名字所说的，是默认的Style，只是这里没有说清楚，这里的默认的Style是指它在当前Application或Activity所用的Theme中的默认Style，以系统中的Button为例说明。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>(context, <span class="keyword">null</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>(context, attrs, com.android.internal.R.attr.buttonStyle);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">Button</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle)</span> </span>&#123;</div><div class="line">    <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在Code中实例化View会调用第一个构造函数，在XML中定义会调用第二个构造函数，在Button的实现中都调用了第三个构造函数，并且defStyle的值是com.android.internal.R.attr.buttonStyle。buttonStyle是系统中定义的一个attribute，系统默认有一个Theme，比如4.0中是Theme.Holo</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;style name="Theme.DeviceDefault" parent="Theme.Holo" &gt;</div><div class="line">    ...</div><div class="line">    &lt;item name="buttonStyle"&gt;@android:style/Widget.DeviceDefault.Button&lt;/item&gt;</div><div class="line">    ....</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure>
<p>上面是系统默认的Theme，为buttonStyle指定了一个Style</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;style name="Widget.DeviceDefault.Button" parent="Widget.Holo.Button" &gt;</div><div class="line">&lt;/style&gt;</div><div class="line"></div><div class="line">&lt;style name="Widget.Holo.Button" parent="Widget.Button"&gt;</div><div class="line">&lt;item name="android:background"&gt;@android:drawable/btn_default_holo_dark&lt;/item&gt;</div><div class="line">    &lt;item name="android:textAppearance"&gt;?android:attr/textAppearanceMedium&lt;/item&gt;</div><div class="line">    &lt;item name="android:textColor"&gt;@android:color/primary_text_holo_dark&lt;/item&gt;</div><div class="line">    &lt;item name="android:minHeight"&gt;48dip&lt;/item&gt;</div><div class="line">    &lt;item name="android:minWidth"&gt;64dip&lt;/item&gt;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure>
<p>这个Style定义了系统中Button的默认属性，如background等。<br>从文档中第三个构造函数的说明中也可以看到，这个构造函数的作用是View的子类提供这个类的基础样式</p>
<blockquote>
<p>View(Context context, AttributeSet attrs, int defStyleAttr)<br>Perform inflation from XML and apply a class-specific base style.</p>
</blockquote>
<p>我们要获取的属性值都是通过这个函数返回的TypedArray获得的，这是官方说明：obtainStyledAttributes，以下是函数原型：<br><code>public TypedArray obtainStyledAttributes (AttributeSet set, int[] attrs, int defStyleAttr, int defStyleRes)</code></p>
<p>set：属性值的集合<br>attrs：我们要获取的属性的资源ID的一个数组，如同ContextProvider中请求数据库时的Projection数组，就是从一堆属性中我们希望查询什么属性的值</p>
<p><strong>defStyleAttr：这个是当前Theme中的一个attribute，是指向style的一个引用，当在layout xml中和style中都没有为View指定属性时，会从Theme中这个attribute指向的Style中查找相应的属性值，这就是defStyle的意思，如果没有指定属性值，就用这个值，所以是默认值，但这个attribute要在Theme中指定，且是指向一个Style的引用，如果这个参数传入0表示不向Theme中搜索默认值</strong></p>
<p>defStyleRes：这个也是指向一个Style的资源ID，但是仅在defStyleAttr为0或defStyleAttr不为0但Theme中没有为defStyleAttr属性赋值时起作用.R.attr.CustomizeStyle就是前面提到的defStyleAttr，R.style.DefaultCustomizeStyle就是defStyleRes。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> CustomTextView(Context context, AttributeSet attrs) &#123;</div><div class="line">    <span class="keyword">this</span>(context, attrs, R.attr.CustomizeStyle);<span class="comment">//R.attr.CustomizeStyle就是前面提到的defStyleAttr</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> CustomTextView(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle) &#123;</div><div class="line">    <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">        </div><div class="line">    TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.Customize, defStyle,</div><div class="line">                R.style.DefaultCustomizeStyle);<span class="comment">//R.style.DefaultCustomizeStyle就是defStyleRes</span></div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>详情<a href="http://www.cnblogs.com/angeldevil/p/3479431.html" target="_blank" rel="external">http://www.cnblogs.com/angeldevil/p/3479431.html</a>  中下位置。</p>
<p>对于一个属性可以在多个地方指定它的值，如XML直接定义，style,Theme，而这些位置定义的值有一个优先级，按优先级从高到低依次是：<br>直接在XML中定义&gt;style定义&gt;由defStyleAttr和defStyleRes指定的默认值&gt;直接在Theme中指定的值</p>
<p><a href="http://www.cnblogs.com/angeldevil/p/3479431.html" target="_blank" rel="external">http://www.cnblogs.com/angeldevil/p/3479431.html</a></p>
<h4 id="10-30-周五-18-50"><a href="#10-30-周五-18-50" class="headerlink" title="10/30 周五 18:50"></a>10/30 周五 18:50</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">backBtn = (Button) findViewById(R.id.back_btn);</div><div class="line">Rect bounds = <span class="keyword">new</span> Rect();</div><div class="line">backBtn.getHitRect(bounds);</div><div class="line">bounds.right += <span class="number">50</span>;</div><div class="line">bounds.left += <span class="number">50</span>;</div><div class="line">TouchDelegate touchDelegate = <span class="keyword">new</span> TouchDelegate(bounds, backBtn);</div><div class="line"><span class="keyword">if</span> (View.<span class="keyword">class</span>.isInstance(backBtn.getParent())) &#123;</div><div class="line">    ((View) backBtn.getParent()).setTouchDelegate(touchDelegate);</div><div class="line">&#125;</div></pre></td></tr></table></figure>

					</div>

			  <!-- about -->
			  
		</div>

		<!-- pagination -->
	  

		<div class="comment-section">
  
  
   <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="_posts/技术随笔-三.md" data-title="技术随笔(三)" data-url="http://jijiaxin89.com/2015/09/26/技术随笔-三/"></div>
    <!-- 多说评论框 end -->
   <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'jijiaxin'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  


</div>
	</div>

	

</div>


		<footer>
			

<p>
  由 <a href="https://hexo.io">hexo</a> 强力驱动 | 搭载 <a href="https://github.com/wayou/hexo-theme-material">material</a> 主题
</p>
<p>
  &copy; 2017 <a href="http://jijiaxin89.com"> 季訫 </a>
</p>
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	  </div>

		<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>

		<!-- material design -->
		<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script>
		<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>
		<!-- toc -->
		<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script src="/libs/tocify/jquery.tocify.custom.js"></script>

		<script src="/js/main.js"></script>

	</body>
</html>
